# rewrite rules
# for https test
domain www.example.io {
  # rewrite / to 8000;
  
  location / {
    proxy_pass http://127.0.0.1:8000/;
    set_header Access-Control-Allow-Origin *;
  }

  location /echo {
    echo <h1>hiproxy echo directive</h1>;
    echo <p>Sends arguments joined by spaces, out to the client.</p>;
    echo <h3>Usage:</h3>;
    echo <pre>;
    echo   echo hello world;;
    echo </pre>;
    echo '<p style="margin-top: 40px; color: red;"><b>Tips</b>: This page is generated by hiproxy</p>';
  }

  location /send_file {
    set $file hosts;
    set_header Content-Type text/html;
    # echo $file<br/>;
    # echo $query_string<br/>;
    send_file ./$query_string;
  }

  location ~ /\/send\/(.*)/ {
    set_header Content-Type text/html;
    send_file ./$1;
  }

  location /info {
    echo <div>current page url: $uri</div>;
    echo <h1>hello_echo</h1>;
    echo <p>test echo directive</p>;
    echo <div>
    echo   <span>div &gt; span</span>
    echo </div>
    echo <p>finish</p>;
    
    # proxy_pass http://127.0.0.1:8000/;
  }

  # http://www.example.io/file?index.html
  location /file {
    send_file ./public/$query_string;
  }

  # http://www.example.io/file/public/index.html
  location ~ /\/file\/(.*)/ {
    send_file ./$1;
  }

  # static files
  location /static/ {
    alias ./public/;

    set_header server hiproxy;
  }
}
